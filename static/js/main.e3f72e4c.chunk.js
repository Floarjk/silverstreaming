(this.webpackJsonpsilverstreaming=this.webpackJsonpsilverstreaming||[]).push([[0],{33:function(e,n,t){e.exports=t(66)},38:function(e,n,t){},39:function(e,n,t){},63:function(e,n){},66:function(e,n,t){"use strict";t.r(n);var c=t(0),a=t.n(c),r=t(31),o=t.n(r),i=(t(38),t(10)),s=(t(39),t(9)),u=t.n(s),d={iceServers:[{urls:"stun:stun.l.google.com:19302"}]};function l(e){var n,t=Object(c.useState)(""),r=Object(i.a)(t,2),o=r[0],s=r[1];return Object(c.useEffect)((function(){var e=u()("http://127.0.0.1:4000");return e.on("offer",(function(t,c){(n=new RTCPeerConnection(d)).setRemoteDescription(c).then((function(){return n.createAnswer()})).then((function(e){return n.setLocalDescription(e)})).then((function(){e.emit("answer",t,n.localDescription)})),n.ontrack=function(e){s(e.streams[0])},n.onicecandidate=function(n){n.candidate&&e.emit("candidate",t,n.candidate)}})),e.on("candidate",(function(e,t){n.addIceCandidate(new RTCIceCandidate(t)).catch((function(e){return console.error(e)}))})),e.on("connect",(function(){e.emit("watcher")})),e.on("broadcaster",(function(){e.emit("watcher")})),e.on("disconnectPeer",(function(){n.close()})),function(){return e.disconnect()}}),[]),a.a.createElement("div",{className:"container"},a.a.createElement("video",{className:"mainVideoPlayer",autoPlay:!0,controls:!0,playsInline:!0,src:o}))}var f=t(16),m=t(32),v={},h={iceServers:[{urls:"stun:stun.l.google.com:19302"}]};function p(e){var n=Object(c.useRef)(),t=Object(c.useRef)(),r=Object(c.useRef)(),o=u()("http://127.0.0.1:4000");function i(){return navigator.mediaDevices.enumerateDevices()}function s(e){window.deviceInfos=e;var c,a=Object(m.a)(e);try{for(a.s();!(c=a.n()).done;){var r=c.value,o=document.createElement("option");o.value=r.deviceId,"audioinput"===r.kind?(o.text=r.label||"Microphone ".concat(n.current.length+1),n.current.appendChild(o)):"videoinput"===r.kind&&(o.text=r.label||"Camera ".concat(t.current.length+1),t.current.appendChild(o))}}catch(i){a.e(i)}finally{a.f()}}function d(){window.stream&&window.stream.getTracks().forEach((function(e){e.stop()}));var e=n.current.value,c=t.current.value,a={audio:{deviceId:e?{exact:e}:void 0},video:{deviceId:c?{exact:c}:void 0}};return navigator.mediaDevices.getUserMedia(a).then(l).catch(p)}function l(e){window.stream=e,n.current.selectedIndex=Object(f.a)(n.current.options).findIndex((function(n){return n.text===e.getAudioTracks()[0].label})),t.current.selectedIndex=Object(f.a)(t.current.options).findIndex((function(n){return n.text===e.getVideoTracks()[0].label})),r.current.srcObject=e,o.emit("broadcaster")}function p(e){console.error("Error: ",e)}return Object(c.useEffect)((function(){d().then(i).then(s)}),[]),Object(c.useEffect)((function(){return o.on("answer",(function(e,n){v[e].setRemoteDescription(n)})),o.on("watcher",(function(e){var n=new RTCPeerConnection(h);v[e]=n;var t=r.current.srcObject;t.getTracks().forEach((function(e){return n.addTrack(e,t)})),n.onicecandidate=function(n){n.candidate&&o.emit("candidate",e,n.candidate)},n.createOffer().then((function(e){return n.setLocalDescription(e)})).then((function(){o.emit("offer",e,n.localDescription)}))})),o.on("candidate",(function(e,n){v[e].addIceCandidate(new RTCIceCandidate(n))})),o.on("disconnectPeer",(function(e){v[e].close(),delete v[e]})),function(){return o.disconnect()}}),[]),a.a.createElement("div",{className:"container"},a.a.createElement("video",{className:"mainVideoPlayer",autoPlay:!0,controls:!0,playsInline:!0}),a.a.createElement("section",{className:"select"},a.a.createElement("select",{ref:n,onChange:d})),a.a.createElement("section",{className:"select"},a.a.createElement("select",{ref:t,onChange:d})))}var w=function(){var e=Object(c.useState)(!0),n=Object(i.a)(e,2),t=n[0],r=n[1];return a.a.createElement("div",{className:"App"},t,t?a.a.createElement(l,null):a.a.createElement(p,null),a.a.createElement("button",{onClick:function(e){e.preventDefault(),r(!t)}},"Clicky"))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[33,1,2]]]);
//# sourceMappingURL=main.e3f72e4c.chunk.js.map